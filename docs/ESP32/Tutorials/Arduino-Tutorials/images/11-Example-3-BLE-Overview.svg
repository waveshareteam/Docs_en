<svg width="1400" height="730" viewBox="20 0 700 365" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="720" height="400" fill="#f8f9fa"/>
  
  <!-- ESP32 A (Peripheral/LED Side) Area - Left -->
  <rect x="50" y="20" width="280" height="250" rx="8" fill="none" stroke="#495057" stroke-width="2"/>
  <text x="70" y="45" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#495057">ESP32 A (Peripheral)</text>
  <text x="70" y="60" font-family="Arial, sans-serif" font-size="11" fill="#6c757d">Device Name: ESP32_LED</text>
  
  <!-- ESP32 A Service: LED Control Service -->
  <rect x="70" y="75" width="240" height="175" rx="6" fill="#f1f3f4" stroke="#6c757d" stroke-width="1.5"/>
  <text x="80" y="95" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#343a40">Service</text>
  <text x="80" y="110" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">LED Brightness Service</text>
  <text x="80" y="123" font-family="Arial, sans-serif" font-size="8" fill="#868e96">UUID: 458063a1-02bf-4664-857e-16c1030be066</text>
  
  <!-- ESP32 A Characteristic: LED Brightness Characteristic -->
  <rect x="85" y="135" width="210" height="85" rx="4" fill="#e9ecef" stroke="#6c757d" stroke-width="1"/>
  <text x="95" y="150" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#343a40">Characteristic</text>
  <text x="95" y="165" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">LED Brightness Char</text>
  <text x="95" y="178" font-family="Arial, sans-serif" font-size="8" fill="#868e96">UUID: a5209632-66a9-411d-9353-9be5507790fa</text>
  <text x="95" y="193" font-family="Arial, sans-serif" font-size="9" fill="#868e96">Properties: Write</text>
  <text x="95" y="208" font-family="Arial, sans-serif" font-size="9" fill="#868e96">Value: 0-255 (Brightness)</text>
  
  <!-- ESP32 A Hardware Connection Area -->
  <rect x="50" y="290" width="280" height="60" rx="6" fill="#f1f3f4" stroke="#6c757d" stroke-width="1.5"/>
  <text x="60" y="310" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#343a40">Hardware Connection</text>
  <text x="60" y="325" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">LED → ESP32 GPIO 7 (via 330Ω Resistor)</text>
  <text x="60" y="338" font-family="Arial, sans-serif" font-size="9" fill="#868e96">Control Mode: PWM Output (0-255)</text>
  
  <!-- ESP32 B (Central/Potentiometer Side) Area - Right (Widened for English) -->
  <rect x="420" y="20" width="260" height="250" rx="8" fill="none" stroke="#495057" stroke-width="2"/>
  <text x="440" y="45" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#495057">ESP32 B (Central)</text>
  <text x="440" y="60" font-family="Arial, sans-serif" font-size="11" fill="#6c757d">Role: BLE Client</text>
  
  <!-- ESP32 B Operation Steps -->
  <rect x="440" y="75" width="220" height="85" rx="6" fill="#f1f3f4" stroke="#6c757d" stroke-width="1.5"/>
  <text x="450" y="95" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#343a40">Operation Steps</text>
  <text x="450" y="112" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">1. Scan &amp; Connect ESP32_LED</text>
  <text x="450" y="127" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">2. Discover Service &amp; Characteristic</text>
  <text x="450" y="142" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">3. Read Potentiometer &amp; Write Value</text>
  
  <!-- ESP32 B Data Processing -->
  <rect x="440" y="175" width="220" height="80" rx="6" fill="#f1f3f4" stroke="#6c757d" stroke-width="1.5"/>
  <text x="450" y="195" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#343a40">Data Processing</text>
  <text x="450" y="212" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">• Raw ADC Value: 0-4095 (12-bit)</text>
  <text x="450" y="227" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">• Map to Brightness: 0-255 (PWM)</text>
  <text x="450" y="242" font-family="Arial, sans-serif" font-size="9" fill="#868e96">(Delta threshold reduces traffic)</text>
  
  <!-- ESP32 B Hardware Connection Area -->
  <rect x="420" y="290" width="260" height="60" rx="6" fill="#f1f3f4" stroke="#6c757d" stroke-width="1.5"/>
  <text x="430" y="310" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#343a40">Hardware Connection</text>
  <text x="430" y="325" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">Potentiometer → ESP32 GPIO 7</text>
  <text x="430" y="338" font-family="Arial, sans-serif" font-size="9" fill="#868e96">ADC Read Range: 0-4095 (12-bit)</text>
  
  <!-- Arrow Definitions -->
  <defs>
    <!-- Arrowhead -->
    <marker id="arrowhead-small" markerWidth="7" markerHeight="5" 
            refX="7" refY="2.5" orient="auto">
      <polygon points="0 0, 7 2.5, 0 5" fill="#6c757d" />
    </marker>
  </defs>
  
  <!-- Data Transmission Arrow (Solid, ESP32 B -> ESP32 A) -->
  <line x1="420" y1="170" x2="330" y2="170" stroke="#6c757d" stroke-width="2" marker-end="url(#arrowhead-small)"/>
  <text x="355" y="165" font-family="Arial, sans-serif" font-size="9" fill="#495057">Write Value</text>
  
  <!-- ESP32 Hardware Connection Arrows -->
  <!-- ESP32 A: From Profile to LED (Down) -->
  <line x1="190" y1="270" x2="190" y2="290" stroke="#6c757d" stroke-width="1.2" marker-end="url(#arrowhead-small)"/>
  <!-- ESP32 B: From Potentiometer to Profile (Up) - Adjusted X for wider box -->
  <line x1="550" y1="290" x2="550" y2="270" stroke="#6c757d" stroke-width="1.2" marker-end="url(#arrowhead-small)"/>
  
</svg>